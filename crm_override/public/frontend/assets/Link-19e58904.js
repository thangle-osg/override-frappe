import{P as U,bz as I,l as O,bN as Z,aB as ee,y as $,z as K,G as te,f as d,g as T,w as x,b as L,A as V,d as h,n as J,c as b,t as M,u as o,aA as R,B as z,S as A,T as N,L as E,aK as ae,aL as se,r as G,F as W,aM as le,K as X,M as H,aC as re,aN as oe,aJ as q,X as ne,e as ue}from"./index-47f22653.js";const Le=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Q(u,k){return U(`${u}-${k+1}-01`)}function De(u,k,s){const l=Q(u,k).startOf("week"),r=Q(u,k).endOf("month").endOf("week"),c=[];let a=l;for(;a.isBefore(r)||a.isSame(r);){const m=a.month()===k,v=U(s);c.push({date:a,key:a.format("YYYY-MM-DD"),inMonth:m,isToday:a.isSame(I().format("YYYY-MM-DD"),"day"),isSelected:v.isValid()&&a.isSame(v,"day")}),a=a.add(1,"day")}const _=[];for(let m=0;m<c.length;m+=7)_.push(c.slice(m,m+7));return _}function ze(u){return!u||u.toString()==="Invalid Date"?"":U(u).set("hour",0).set("minute",0).set("second",0).set("millisecond",0).format("YYYY-MM-DD")}const ie={class:"w-full"},de=["onClick"],ce={key:0,class:"flex text-base leading-5 items-center truncate"},fe={class:"truncate"},me={key:1,class:"absolute text-ink-gray-4 text-left truncate w-full pr-7"},pe={class:"relative mt-1 rounded-lg bg-surface-modal text-base shadow-2xl"},ye={class:"relative px-1.5 pt-1.5"},ge={key:0,class:"truncate bg-surface-modal px-2.5 py-1.5 text-sm font-medium text-ink-gray-5"},be={class:"flex-1 truncate text-ink-gray-7"},he={key:0,class:"my-1.5 rounded-md px-2.5 py-1.5 text-base text-ink-gray-5"},ve={key:0,class:"border-t border-outline-gray-modals p-1.5"},xe={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},placement:{type:String,default:"bottom-start"}},emits:["update:modelValue","update:query","change"],setup(u,{expose:k,emit:s}){const l=u,r=s,c=O(""),a=O(!1),_=O(null),m=Z(),v=ee(),D=$(()=>"value"in m),S=$({get(){return D.value?m.value:l.modelValue},set(t){c.value="",t&&(a.value=!1),r(D.value?"change":"update:modelValue",t)}});function P(){a.value=!1}const e=$(()=>{var n;return!l.options||l.options.length==0?[]:((n=l.options[0])!=null&&n.group?l.options:[{group:"",items:l.options}]).map((i,f)=>({key:f,group:i.group,hideLabel:i.hideLabel||!1,items:l.filterable?w(i.items):i.items})).filter(i=>i.items.length>0)});function w(t){return c.value?t.filter(n=>[n.label,n.value].some(f=>(f||"").toString().toLowerCase().includes(c.value.toLowerCase()))):t}function y(t){if(typeof t=="string"){let i=e.value.flatMap(f=>f.items).find(f=>f.value===t);return(i==null?void 0:i.label)||t}return t==null?void 0:t.label}K(c,t=>{r("update:query",t)}),K(a,t=>{t&&te(()=>{_.value.el.focus()})});const p=$(()=>l.disabled?"text-ink-gray-5":"text-ink-gray-8"),g=$(()=>{let t={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[l.size],n={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[l.size],i=l.disabled?"disabled":l.variant,f={subtle:"border border-gray-100 bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",outline:"border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",disabled:["border bg-surface-menu-bar placeholder-ink-gray-3",l.variant==="outline"?"border-outline-gray-2":"border-transparent"]}[i];return[t,n,f,p.value,"transition-colors w-full"]});return k({query:c}),(t,n)=>(d(),T(o(oe),{modelValue:S.value,"onUpdate:modelValue":n[3]||(n[3]=i=>S.value=i),nullable:""},{default:x(({open:i})=>[L(o(re),{class:"w-full",show:a.value,"onUpdate:show":n[2]||(n[2]=f=>a.value=f),placement:u.placement},{target:x(({open:f,togglePopover:B})=>[V(t.$slots,"target",A(N({open:f,togglePopover:B,isOpen:a.value,selectedValue:S.value,displayValue:y})),()=>[h("div",ie,[h("button",{class:J(["relative flex h-7 w-full items-center justify-between gap-2 rounded px-2 py-1 transition-colors",g.value]),onClick:()=>!u.disabled&&B()},[S.value?(d(),b("div",ce,[V(t.$slots,"prefix"),h("span",fe,M(y(S.value)),1)])):(d(),b("div",me,M(u.placeholder||""),1)),u.disabled?z("",!0):(d(),T(o(R),{key:2,name:"chevron-down",class:"absolute h-4 w-4 text-ink-gray-5 right-2","aria-hidden":"true"}))],10,de)])])]),body:x(({isOpen:f})=>{var B;return[E(h("div",null,[h("div",pe,[h("div",ye,[L(o(ae),{ref_key:"search",ref:_,class:"form-input w-full focus:bg-surface-gray-3 hover:bg-surface-gray-4 text-ink-gray-8",type:"text",onChange:n[0]||(n[0]=C=>{c.value=C.target.value}),value:c.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),h("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:n[1]||(n[1]=C=>S.value=null)},[L(o(R),{name:"x",class:"w-4 text-ink-gray-8"})])]),L(o(se),{class:"my-1 max-h-[12rem] overflow-y-auto p-1.5 pt-0",static:""},{default:x(()=>[(d(!0),b(W,null,G(e.value,C=>E((d(),b("div",{class:"mt-1.5",key:C.key},[C.group&&!C.hideLabel?(d(),b("div",ge,M(C.group),1)):z("",!0),(d(!0),b(W,null,G(C.items,Y=>(d(),T(o(le),{as:"template",key:Y.value,value:Y},{default:x(({active:j,selected:F})=>[h("li",{class:J(["flex cursor-pointer items-center rounded px-2.5 py-1.5 text-base",{"bg-surface-gray-3":j}])},[V(t.$slots,"item-prefix",X({ref_for:!0},{active:j,selected:F,option:Y})),V(t.$slots,"item-label",X({ref_for:!0},{active:j,selected:F,option:Y}),()=>[h("div",be,M(Y.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[H,C.items.length>0]])),128)),e.value.length==0?(d(),b("li",he," No results found ")):z("",!0)]),_:3}),o(v).footer?(d(),b("div",ve,[V(t.$slots,"footer",A(N({value:(B=_.value)==null?void 0:B.el._value,close:P})))])):z("",!0)])],512),[[H,f]])]}),_:3},8,["show","placement"])]),_:3},8,["modelValue"]))}},ke={class:"space-y-1.5 p-[2px] -m-[2px]"},_e={key:0,class:"flex flex-col gap-1"},we={class:"flex-1 font-semibold truncate text-ink-gray-7"},Ce={class:"flex-1 text-sm truncate text-ink-gray-5"},Ve={key:1,class:"flex-1 truncate text-ink-gray-7"},Se={key:0},$e={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:[Array,Object,String],default:[]},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(u,{emit:k}){const s=u,l=k,r=Z(),c=$(()=>"value"in r),a=$({get:()=>c.value?r.value:s.modelValue,set:e=>(e==null?void 0:e.value)&&l(c.value?"change":"update:modelValue",e==null?void 0:e.value)}),_=O(null),m=O("");q(()=>{var e;return(e=_.value)==null?void 0:e.query},e=>{e=e||"",m.value!==e&&(m.value=e,D(e))},{debounce:300,immediate:!0}),q(()=>s.doctype,()=>D(""),{debounce:300,immediate:!0}),q(()=>s.filters,()=>{D("",!0)},{debounce:300,immediate:!0});const v=ne({url:"frappe.desk.search.search_link",cache:[s.doctype,m.value,s.hideMe,s.filters],method:"POST",params:{txt:m.value,doctype:s.doctype,filters:s.filters},transform:e=>{let w=e.map(y=>({label:y.label||y.value,value:y.value,description:y.description}));return!s.hideMe&&s.doctype=="User"&&w.unshift({label:"@me",value:"@me"}),w}});function D(e,w=!1){var y,p,g;s.doctype&&(!w&&((y=v.data)!=null&&y.length)&&e===((p=v.params)==null?void 0:p.txt)&&s.doctype===((g=v.params)==null?void 0:g.doctype)||(v.update({params:{txt:e,doctype:s.doctype,filters:s.filters}}),v.reload()))}function S(e){l(c.value?"change":"update:modelValue",""),e()}const P=$(()=>[{sm:"text-xs",md:"text-base"}[r.size||"sm"],"text-ink-gray-5"]);return(e,w)=>{const y=ue("Button");return d(),b("div",ke,[o(r).label?(d(),b("label",{key:0,class:J(["block",P.value])},M(e.__(o(r).label)),3)):z("",!0),L(xe,{ref_key:"autocomplete",ref:_,options:o(v).data,modelValue:a.value,"onUpdate:modelValue":w[0]||(w[0]=p=>a.value=p),size:o(r).size||"sm",variant:o(r).variant,placeholder:o(r).placeholder,disabled:o(r).disabled,placement:o(r).placement,filterable:!1},{target:x(({open:p,togglePopover:g})=>[V(e.$slots,"target",A(N({open:p,togglePopover:g})))]),prefix:x(()=>[V(e.$slots,"prefix")]),"item-prefix":x(({active:p,selected:g,option:t})=>[V(e.$slots,"item-prefix",A(N({active:p,selected:g,option:t})))]),"item-label":x(({active:p,selected:g,option:t})=>[V(e.$slots,"item-label",A(N({active:p,selected:g,option:t})),()=>[t.description?(d(),b("div",_e,[h("div",we,M(t.label),1),h("div",Ce,M(t.description),1)])):(d(),b("div",Ve,M(t.label),1))])]),footer:x(({value:p,close:g})=>[o(r).onCreate?(d(),b("div",Se,[L(y,{variant:"ghost",class:"w-full !justify-start",label:e.__("Create New"),iconLeft:"plus",onClick:()=>o(r).onCreate(p,g)},null,8,["label","onClick"])])):z("",!0),h("div",null,[L(y,{variant:"ghost",class:"w-full !justify-start",label:e.__("Clear"),iconLeft:"x",onClick:()=>S(g)},null,8,["label","onClick"])])]),_:3},8,["options","modelValue","size","variant","placeholder","disabled","placement"])])}}},Be=$e;export{Be as L,xe as _,Q as a,ze as b,De as g,Le as m};
//# sourceMappingURL=Link-19e58904.js.map
