{"version":3,"file":"Deals-890a1a7f.js","sources":["../../../../frontend/src/components/Modals/DealModal.vue","../../../../frontend/src/pages/Deals.vue"],"sourcesContent":["<template>\n  <Dialog v-model=\"show\" :options=\"{ size: '3xl' }\">\n    <template #body>\n      <div class=\"bg-surface-modal px-4 pb-6 pt-5 sm:px-6\">\n        <div class=\"mb-5 flex items-center justify-between\">\n          <div>\n            <h3 class=\"text-2xl font-semibold leading-6 text-ink-gray-9\">\n              {{ __('Create Deal') }}\n            </h3>\n          </div>\n          <div class=\"flex items-center gap-1\">\n            <Button\n              v-if=\"isManager() && !isMobileView\"\n              variant=\"ghost\"\n              class=\"w-7\"\n              :tooltip=\"__('Edit fields layout')\"\n              :icon=\"EditIcon\"\n              @click=\"openQuickEntryModal\"\n            />\n            <Button\n              variant=\"ghost\"\n              class=\"w-7\"\n              icon=\"x\"\n              @click=\"show = false\"\n            />\n          </div>\n        </div>\n        <div>\n          <div\n            v-if=\"hasOrganizationSections || hasContactSections\"\n            class=\"mb-4 grid grid-cols-1 gap-4 sm:grid-cols-3\"\n          >\n            <div\n              v-if=\"hasOrganizationSections\"\n              class=\"flex items-center gap-3 text-sm text-ink-gray-5\"\n            >\n              <div>{{ __('Choose Existing Organization') }}</div>\n              <Switch v-model=\"chooseExistingOrganization\" />\n            </div>\n            <div\n              v-if=\"hasContactSections\"\n              class=\"flex items-center gap-3 text-sm text-ink-gray-5\"\n            >\n              <div>{{ __('Choose Existing Contact') }}</div>\n              <Switch v-model=\"chooseExistingContact\" />\n            </div>\n          </div>\n          <div\n            v-if=\"hasOrganizationSections || hasContactSections\"\n            class=\"h-px w-full border-t my-5\"\n          />\n          <FieldLayout\n            ref=\"fieldLayoutRef\"\n            v-if=\"tabs.data?.length\"\n            :tabs=\"tabs.data\"\n            :data=\"deal.doc\"\n            doctype=\"CRM Deal\"\n          />\n          <ErrorMessage class=\"mt-4\" v-if=\"error\" :message=\"__(error)\" />\n        </div>\n      </div>\n      <div class=\"px-4 pb-7 pt-4 sm:px-6\">\n        <div class=\"flex flex-row-reverse gap-2\">\n          <Button\n            variant=\"solid\"\n            :label=\"__('Create')\"\n            :loading=\"isDealCreating\"\n            @click=\"createDeal\"\n          />\n        </div>\n      </div>\n    </template>\n  </Dialog>\n</template>\n\n<script setup>\nimport EditIcon from '@/components/Icons/EditIcon.vue'\nimport FieldLayout from '@/components/FieldLayout/FieldLayout.vue'\nimport { usersStore } from '@/stores/users'\nimport { statusesStore } from '@/stores/statuses'\nimport { isMobileView } from '@/composables/settings'\nimport { showQuickEntryModal, quickEntryProps } from '@/composables/modals'\nimport { useDocument } from '@/data/document'\nimport { capture } from '@/telemetry'\nimport { Switch, createResource } from 'frappe-ui'\nimport { computed, ref, onMounted, nextTick, watch } from 'vue'\nimport { useRouter } from 'vue-router'\n\nconst props = defineProps({\n  defaults: Object,\n})\n\nconst { getUser, isManager } = usersStore()\nconst { getDealStatus, statusOptions } = statusesStore()\n\nconst show = defineModel()\nconst router = useRouter()\nconst error = ref(null)\n\nconst { document: deal, triggerOnBeforeCreate } = useDocument('CRM Deal')\n\nconst hasOrganizationSections = ref(true)\nconst hasContactSections = ref(true)\n\nconst isDealCreating = ref(false)\nconst chooseExistingContact = ref(false)\nconst chooseExistingOrganization = ref(false)\nconst fieldLayoutRef = ref(null)\n\nwatch(\n  [chooseExistingOrganization, chooseExistingContact],\n  ([organization, contact]) => {\n    tabs.data.forEach((tab) => {\n      tab.sections.forEach((section) => {\n        if (section.name === 'organization_section') {\n          section.hidden = !organization\n        } else if (section.name === 'organization_details_section') {\n          section.hidden = organization\n        } else if (section.name === 'contact_section') {\n          section.hidden = !contact\n        } else if (section.name === 'contact_details_section') {\n          section.hidden = contact\n        }\n      })\n    })\n  },\n)\n\nconst tabs = createResource({\n  url: 'crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout',\n  cache: ['QuickEntry', 'CRM Deal'],\n  params: { doctype: 'CRM Deal', type: 'Quick Entry' },\n  auto: true,\n  transform: (_tabs) => {\n    hasOrganizationSections.value = false\n    return _tabs.forEach((tab) => {\n      tab.sections.forEach((section) => {\n        section.columns.forEach((column) => {\n          if (\n            ['organization_section', 'organization_details_section'].includes(\n              section.name,\n            )\n          ) {\n            hasOrganizationSections.value = true\n          } else if (\n            ['contact_section', 'contact_details_section'].includes(\n              section.name,\n            )\n          ) {\n            hasContactSections.value = true\n          }\n          column.fields.forEach((field) => {\n            if (field.fieldname == 'status') {\n              field.fieldtype = 'Select'\n              field.options = dealStatuses.value\n              field.prefix = getDealStatus(deal.doc.status).color\n            }\n\n            if (field.fieldtype === 'Table') {\n              deal.doc[field.fieldname] = []\n            }\n          })\n        })\n      })\n    })\n  },\n})\n\nconst dealStatuses = computed(() => {\n  let statuses = statusOptions('deal')\n  if (!deal.doc.status) {\n    deal.doc.status = statuses[0].value\n  }\n  return statuses\n})\n\nasync function createDeal() {\n  if (deal.doc.website && !deal.doc.website.startsWith('http')) {\n    deal.doc.website = 'https://' + deal.doc.website\n  }\n  if (chooseExistingContact.value) {\n    deal.doc['first_name'] = null\n    deal.doc['last_name'] = null\n    deal.doc['email'] = null\n    deal.doc['mobile_no'] = null\n  } else deal.doc['contact'] = null\n\n  await triggerOnBeforeCreate?.()\n\n  createResource({\n    url: 'crm.fcrm.doctype.crm_deal.crm_deal.create_deal',\n    params: { args: deal.doc },\n    auto: true,\n    validate() {\n      error.value = null\n      if (deal.doc.annual_revenue) {\n        if (typeof deal.doc.annual_revenue === 'string') {\n          deal.doc.annual_revenue = deal.doc.annual_revenue.replace(/,/g, '')\n        } else if (isNaN(deal.doc.annual_revenue)) {\n          error.value = __('Annual Revenue should be a number')\n          return error.value\n        }\n      }\n      if (\n        deal.doc.mobile_no &&\n        isNaN(deal.doc.mobile_no.replace(/[-+() ]/g, ''))\n      ) {\n        error.value = __('Mobile No should be a number')\n        return error.value\n      }\n      if (deal.doc.email && !deal.doc.email.includes('@')) {\n        error.value = __('Invalid Email')\n        return error.value\n      }\n      if (!deal.doc.status) {\n        error.value = __('Status is required')\n        return error.value\n      }\n      isDealCreating.value = true\n    },\n    onSuccess(name) {\n      capture('deal_created')\n      isDealCreating.value = false\n      show.value = false\n      router.push({ name: 'Deal', params: { dealId: name } })\n    },\n    onError(err) {\n      isDealCreating.value = false\n      if (!err.messages) {\n        error.value = err.message\n        return\n      }\n      error.value = err.messages.join('\\n')\n    },\n  })\n}\n\nfunction openQuickEntryModal() {\n  showQuickEntryModal.value = true\n  quickEntryProps.value = { doctype: 'CRM Deal' }\n  nextTick(() => (show.value = false))\n}\n\nonMounted(() => {\n  deal.doc = { no_of_employees: '1-10' }\n  Object.assign(deal.doc, props.defaults)\n\n  if (!deal.doc.deal_owner) {\n    deal.doc.deal_owner = getUser().name\n  }\n  if (!deal.doc.status && dealStatuses.value[0].value) {\n    deal.doc.status = dealStatuses.value[0].value\n  }\n})\n</script>\n","<template>\n  <LayoutHeader>\n    <template #left-header>\n      <ViewBreadcrumbs v-model=\"viewControls\" routeName=\"Deals\" />\n    </template>\n    <template #right-header>\n      <CustomActions\n        v-if=\"dealsListView?.customListActions\"\n        :actions=\"dealsListView.customListActions\"\n      />\n      <Button\n        variant=\"solid\"\n        :label=\"__('Create')\"\n        iconLeft=\"plus\"\n        @click=\"showDealModal = true\"\n      />\n    </template>\n  </LayoutHeader>\n  <ViewControls\n    ref=\"viewControls\"\n    v-model=\"deals\"\n    v-model:loadMore=\"loadMore\"\n    v-model:resizeColumn=\"triggerResize\"\n    v-model:updatedPageCount=\"updatedPageCount\"\n    doctype=\"CRM Deal\"\n    :options=\"{\n      allowedViews: ['list', 'group_by', 'kanban'],\n    }\"\n  />\n  <KanbanView\n    v-if=\"route.params.viewType == 'kanban'\"\n    v-model=\"deals\"\n    :options=\"{\n      getRoute: (row) => ({\n        name: 'Deal',\n        params: { dealId: row.name },\n        query: { view: route.query.view, viewType: route.params.viewType },\n      }),\n      onNewClick: (column) => onNewClick(column),\n    }\"\n    @update=\"(data) => viewControls.updateKanbanSettings(data)\"\n    @loadMore=\"(columnName) => viewControls.loadMoreKanban(columnName)\"\n  >\n    <template #title=\"{ titleField, itemName }\">\n      <div class=\"flex gap-2 items-center\">\n        <div v-if=\"titleField === 'status'\">\n          <IndicatorIcon :class=\"getRow(itemName, titleField).color\" />\n        </div>\n        <div\n          v-else-if=\"\n            titleField === 'organization' && getRow(itemName, titleField).label\n          \"\n        >\n          <Avatar\n            class=\"flex items-center\"\n            :image=\"getRow(itemName, titleField).logo\"\n            :label=\"getRow(itemName, titleField).label\"\n            size=\"sm\"\n          />\n        </div>\n        <div\n          v-else-if=\"\n            titleField === 'deal_owner' &&\n            getRow(itemName, titleField).full_name\n          \"\n        >\n          <Avatar\n            class=\"flex items-center\"\n            :image=\"getRow(itemName, titleField).user_image\"\n            :label=\"getRow(itemName, titleField).full_name\"\n            size=\"sm\"\n          />\n        </div>\n        <div\n          v-if=\"\n            [\n              'modified',\n              'creation',\n              'first_response_time',\n              'first_responded_on',\n              'response_by',\n            ].includes(titleField)\n          \"\n          class=\"truncate text-base\"\n        >\n          <Tooltip :text=\"getRow(itemName, titleField).label\">\n            <div>{{ getRow(itemName, titleField).timeAgo }}</div>\n          </Tooltip>\n        </div>\n        <div v-else-if=\"titleField === 'sla_status'\" class=\"truncate text-base\">\n          <Badge\n            v-if=\"getRow(itemName, titleField).value\"\n            :variant=\"'subtle'\"\n            :theme=\"getRow(itemName, titleField).color\"\n            size=\"md\"\n            :label=\"getRow(itemName, titleField).value\"\n          />\n        </div>\n        <div\n          v-else-if=\"getRow(itemName, titleField).label\"\n          class=\"truncate text-base\"\n        >\n          {{ getRow(itemName, titleField).label }}\n        </div>\n        <div class=\"text-ink-gray-4\" v-else>{{ __('No Title') }}</div>\n      </div>\n    </template>\n\n    <template #fields=\"{ fieldName, itemName }\">\n      <div\n        v-if=\"getRow(itemName, fieldName).label\"\n        class=\"truncate flex items-center gap-2\"\n      >\n        <div v-if=\"fieldName === 'status'\">\n          <IndicatorIcon :class=\"getRow(itemName, fieldName).color\" />\n        </div>\n        <div v-else-if=\"fieldName === 'organization'\">\n          <Avatar\n            v-if=\"getRow(itemName, fieldName).label\"\n            class=\"flex items-center\"\n            :image=\"getRow(itemName, fieldName).logo\"\n            :label=\"getRow(itemName, fieldName).label\"\n            size=\"xs\"\n          />\n        </div>\n        <div v-else-if=\"fieldName === 'deal_owner'\">\n          <Avatar\n            v-if=\"getRow(itemName, fieldName).full_name\"\n            class=\"flex items-center\"\n            :image=\"getRow(itemName, fieldName).user_image\"\n            :label=\"getRow(itemName, fieldName).full_name\"\n            size=\"xs\"\n          />\n        </div>\n        <div\n          v-if=\"\n            [\n              'modified',\n              'creation',\n              'first_response_time',\n              'first_responded_on',\n              'response_by',\n            ].includes(fieldName)\n          \"\n          class=\"truncate text-base\"\n        >\n          <Tooltip :text=\"getRow(itemName, fieldName).label\">\n            <div>{{ getRow(itemName, fieldName).timeAgo }}</div>\n          </Tooltip>\n        </div>\n        <div v-else-if=\"fieldName === 'sla_status'\" class=\"truncate text-base\">\n          <Badge\n            v-if=\"getRow(itemName, fieldName).value\"\n            :variant=\"'subtle'\"\n            :theme=\"getRow(itemName, fieldName).color\"\n            size=\"md\"\n            :label=\"getRow(itemName, fieldName).value\"\n          />\n        </div>\n        <div v-else-if=\"fieldName === '_assign'\" class=\"flex items-center\">\n          <MultipleAvatar\n            :avatars=\"getRow(itemName, fieldName).label\"\n            size=\"xs\"\n          />\n        </div>\n        <div v-else class=\"truncate text-base\">\n          {{ getRow(itemName, fieldName).label }}\n        </div>\n      </div>\n    </template>\n\n    <template #actions=\"{ itemName }\">\n      <div class=\"flex gap-2 items-center justify-between\">\n        <div class=\"text-ink-gray-5 flex items-center gap-1.5\">\n          <EmailAtIcon class=\"h-4 w-4\" />\n          <span v-if=\"getRow(itemName, '_email_count').label\">\n            {{ getRow(itemName, '_email_count').label }}\n          </span>\n          <span class=\"text-3xl leading-[0]\"> &middot; </span>\n          <NoteIcon class=\"h-4 w-4\" />\n          <span v-if=\"getRow(itemName, '_note_count').label\">\n            {{ getRow(itemName, '_note_count').label }}\n          </span>\n          <span class=\"text-3xl leading-[0]\"> &middot; </span>\n          <TaskIcon class=\"h-4 w-4\" />\n          <span v-if=\"getRow(itemName, '_task_count').label\">\n            {{ getRow(itemName, '_task_count').label }}\n          </span>\n          <span class=\"text-3xl leading-[0]\"> &middot; </span>\n          <CommentIcon class=\"h-4 w-4\" />\n          <span v-if=\"getRow(itemName, '_comment_count').label\">\n            {{ getRow(itemName, '_comment_count').label }}\n          </span>\n        </div>\n        <Dropdown\n          class=\"flex items-center gap-2\"\n          :options=\"actions(itemName)\"\n          variant=\"ghost\"\n          @click.stop.prevent\n        >\n          <Button icon=\"plus\" variant=\"ghost\" />\n        </Dropdown>\n      </div>\n    </template>\n  </KanbanView>\n  <DealsListView\n    ref=\"dealsListView\"\n    v-else-if=\"deals.data && rows.length\"\n    v-model=\"deals.data.page_length_count\"\n    v-model:list=\"deals\"\n    :rows=\"rows\"\n    :columns=\"deals.data.columns\"\n    :options=\"{\n      showTooltip: false,\n      resizeColumn: true,\n      rowCount: deals.data.row_count,\n      totalCount: deals.data.total_count,\n    }\"\n    @loadMore=\"() => loadMore++\"\n    @columnWidthUpdated=\"() => triggerResize++\"\n    @updatePageCount=\"(count) => (updatedPageCount = count)\"\n    @applyFilter=\"(data) => viewControls.applyFilter(data)\"\n    @applyLikeFilter=\"(data) => viewControls.applyLikeFilter(data)\"\n    @likeDoc=\"(data) => viewControls.likeDoc(data)\"\n    @selectionsChanged=\"\n      (selections) => viewControls.updateSelections(selections)\n    \"\n  />\n  <div v-else-if=\"deals.data\" class=\"flex h-full items-center justify-center\">\n    <div\n      class=\"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4\"\n    >\n      <DealsIcon class=\"h-10 w-10\" />\n      <span>{{ __('No {0} Found', [__('Deals')]) }}</span>\n      <Button\n        :label=\"__('Create')\"\n        iconLeft=\"plus\"\n        @click=\"showDealModal = true\"\n      />\n    </div>\n  </div>\n  <DealModal\n    v-if=\"showDealModal\"\n    v-model=\"showDealModal\"\n    :defaults=\"defaults\"\n  />\n  <NoteModal\n    v-if=\"showNoteModal\"\n    v-model=\"showNoteModal\"\n    :note=\"note\"\n    doctype=\"CRM Deal\"\n    :doc=\"docname\"\n  />\n  <TaskModal\n    v-if=\"showTaskModal\"\n    v-model=\"showTaskModal\"\n    :task=\"task\"\n    doctype=\"CRM Deal\"\n    :doc=\"docname\"\n  />\n</template>\n\n<script setup>\nimport ViewBreadcrumbs from '@/components/ViewBreadcrumbs.vue'\nimport MultipleAvatar from '@/components/MultipleAvatar.vue'\nimport CustomActions from '@/components/CustomActions.vue'\nimport EmailAtIcon from '@/components/Icons/EmailAtIcon.vue'\nimport PhoneIcon from '@/components/Icons/PhoneIcon.vue'\nimport NoteIcon from '@/components/Icons/NoteIcon.vue'\nimport TaskIcon from '@/components/Icons/TaskIcon.vue'\nimport CommentIcon from '@/components/Icons/CommentIcon.vue'\nimport IndicatorIcon from '@/components/Icons/IndicatorIcon.vue'\nimport DealsIcon from '@/components/Icons/DealsIcon.vue'\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport DealsListView from '@/components/ListViews/DealsListView.vue'\nimport KanbanView from '@/components/Kanban/KanbanView.vue'\nimport DealModal from '@/components/Modals/DealModal.vue'\nimport NoteModal from '@/components/Modals/NoteModal.vue'\nimport TaskModal from '@/components/Modals/TaskModal.vue'\nimport ViewControls from '@/components/ViewControls.vue'\nimport { getMeta } from '@/stores/meta'\nimport { globalStore } from '@/stores/global'\nimport { usersStore } from '@/stores/users'\nimport { organizationsStore } from '@/stores/organizations'\nimport { statusesStore } from '@/stores/statuses'\nimport { callEnabled } from '@/composables/settings'\nimport { formatDate, timeAgo, website, formatTime } from '@/utils'\nimport { Tooltip, Avatar, Dropdown } from 'frappe-ui'\nimport { useRoute } from 'vue-router'\nimport { ref, reactive, computed, h } from 'vue'\n\nconst { getFormattedPercent, getFormattedFloat, getFormattedCurrency } =\n  getMeta('CRM Deal')\nconst { makeCall } = globalStore()\nconst { getUser } = usersStore()\nconst { getOrganization } = organizationsStore()\nconst { getDealStatus } = statusesStore()\n\nconst route = useRoute()\n\nconst dealsListView = ref(null)\nconst showDealModal = ref(false)\n\nconst defaults = reactive({})\n\n// deals data is loaded in the ViewControls component\nconst deals = ref({})\nconst loadMore = ref(1)\nconst triggerResize = ref(1)\nconst updatedPageCount = ref(20)\nconst viewControls = ref(null)\n\nfunction getRow(name, field) {\n  function getValue(value) {\n    if (value && typeof value === 'object' && !Array.isArray(value)) {\n      return value\n    }\n    return { label: value }\n  }\n  return getValue(rows.value?.find((row) => row.name == name)[field])\n}\n\n// Rows\nconst rows = computed(() => {\n  if (!deals.value?.data?.data) return []\n  if (deals.value.data.view_type === 'group_by') {\n    if (!deals.value?.data.group_by_field?.fieldname) return []\n    return getGroupedByRows(\n      deals.value?.data.data,\n      deals.value?.data.group_by_field,\n      deals.value.data.columns,\n    )\n  } else if (deals.value.data.view_type === 'kanban') {\n    return getKanbanRows(deals.value.data.data, deals.value.data.fields)\n  } else {\n    return parseRows(deals.value?.data.data, deals.value.data.columns)\n  }\n})\n\nfunction getGroupedByRows(listRows, groupByField, columns) {\n  let groupedRows = []\n\n  groupByField.options?.forEach((option) => {\n    let filteredRows = []\n\n    if (!option) {\n      filteredRows = listRows.filter((row) => !row[groupByField.fieldname])\n    } else {\n      filteredRows = listRows.filter(\n        (row) => row[groupByField.fieldname] == option,\n      )\n    }\n\n    let groupDetail = {\n      label: groupByField.label,\n      group: option || __(' '),\n      collapsed: false,\n      rows: parseRows(filteredRows, columns),\n    }\n    if (groupByField.fieldname == 'status') {\n      groupDetail.icon = () =>\n        h(IndicatorIcon, {\n          class: getDealStatus(option)?.color,\n        })\n    }\n    groupedRows.push(groupDetail)\n  })\n\n  return groupedRows || listRows\n}\n\nfunction getKanbanRows(data, columns) {\n  let _rows = []\n  data.forEach((column) => {\n    column.data?.forEach((row) => {\n      _rows.push(row)\n    })\n  })\n  return parseRows(_rows, columns)\n}\n\nfunction parseRows(rows, columns = []) {\n  let view_type = deals.value.data.view_type\n  let key = view_type === 'kanban' ? 'fieldname' : 'key'\n  let type = view_type === 'kanban' ? 'fieldtype' : 'type'\n\n  return rows.map((deal) => {\n    let _rows = {}\n    deals.value.data.rows.forEach((row) => {\n      _rows[row] = deal[row]\n\n      let fieldType = columns?.find((col) => (col[key] || col.value) == row)?.[\n        type\n      ]\n\n      if (\n        fieldType &&\n        ['Date', 'Datetime'].includes(fieldType) &&\n        !['modified', 'creation'].includes(row)\n      ) {\n        _rows[row] = formatDate(deal[row], '', true, fieldType == 'Datetime')\n      }\n\n      if (fieldType && fieldType == 'Currency') {\n        _rows[row] = getFormattedCurrency(row, deal)\n      }\n\n      if (fieldType && fieldType == 'Float') {\n        _rows[row] = getFormattedFloat(row, deal)\n      }\n\n      if (fieldType && fieldType == 'Percent') {\n        _rows[row] = getFormattedPercent(row, deal)\n      }\n\n      if (row == 'organization') {\n        _rows[row] = {\n          label: deal.organization,\n          logo: getOrganization(deal.organization)?.organization_logo,\n        }\n      } else if (row === 'website') {\n        _rows[row] = website(deal.website)\n      } else if (row == 'status') {\n        _rows[row] = {\n          label: deal.status,\n          color: getDealStatus(deal.status)?.color,\n        }\n      } else if (row == 'sla_status') {\n        let value = deal.sla_status\n        let tooltipText = value\n        let color =\n          deal.sla_status == 'Failed'\n            ? 'red'\n            : deal.sla_status == 'Fulfilled'\n              ? 'green'\n              : 'orange'\n        if (value == 'First Response Due' || value == 'Rolling Response Due') {\n          value = __(timeAgo(deal.response_by))\n          tooltipText = formatDate(deal.response_by)\n          if (new Date(deal.response_by) < new Date()) {\n            color = 'red'\n          }\n        }\n        _rows[row] = {\n          label: tooltipText,\n          value: value,\n          color: color,\n        }\n      } else if (row == 'deal_owner') {\n        _rows[row] = {\n          label: deal.deal_owner && getUser(deal.deal_owner).full_name,\n          ...(deal.deal_owner && getUser(deal.deal_owner)),\n        }\n      } else if (row == '_assign') {\n        let assignees = JSON.parse(deal._assign || '[]')\n        _rows[row] = assignees.map((user) => ({\n          name: user,\n          image: getUser(user).user_image,\n          label: getUser(user).full_name,\n        }))\n      } else if (['modified', 'creation'].includes(row)) {\n        _rows[row] = {\n          label: formatDate(deal[row]),\n          timeAgo: __(timeAgo(deal[row])),\n        }\n      } else if (\n        ['first_response_time', 'first_responded_on', 'response_by'].includes(\n          row,\n        )\n      ) {\n        let field = row == 'response_by' ? 'response_by' : 'first_responded_on'\n        _rows[row] = {\n          label: deal[field] ? formatDate(deal[field]) : '',\n          timeAgo: deal[row]\n            ? row == 'first_response_time'\n              ? formatTime(deal[row])\n              : __(timeAgo(deal[row]))\n            : '',\n        }\n      }\n    })\n    _rows['_email_count'] = deal._email_count\n    _rows['_note_count'] = deal._note_count\n    _rows['_task_count'] = deal._task_count\n    _rows['_comment_count'] = deal._comment_count\n    return _rows\n  })\n}\n\nfunction onNewClick(column) {\n  let column_field = deals.value.params.column_field\n\n  if (column_field) {\n    defaults[column_field] = column.column.name\n  }\n\n  showDealModal.value = true\n}\n\nfunction actions(itemName) {\n  let mobile_no = getRow(itemName, 'mobile_no')?.label || ''\n  let actions = [\n    {\n      icon: h(PhoneIcon, { class: 'h-4 w-4' }),\n      label: __('Make a Call'),\n      onClick: () => makeCall(mobile_no),\n      condition: () => mobile_no && callEnabled.value,\n    },\n    {\n      icon: h(NoteIcon, { class: 'h-4 w-4' }),\n      label: __('New Note'),\n      onClick: () => showNote(itemName),\n    },\n    {\n      icon: h(TaskIcon, { class: 'h-4 w-4' }),\n      label: __('New Task'),\n      onClick: () => showTask(itemName),\n    },\n  ]\n  return actions.filter((action) =>\n    action.condition ? action.condition() : true,\n  )\n}\n\nconst docname = ref('')\nconst showNoteModal = ref(false)\nconst note = ref({\n  title: '',\n  content: '',\n})\n\nfunction showNote(name) {\n  docname.value = name\n  showNoteModal.value = true\n}\n\nconst showTaskModal = ref(false)\nconst task = ref({\n  title: '',\n  description: '',\n  assigned_to: '',\n  due_date: '',\n  priority: 'Low',\n  status: 'Backlog',\n})\n\nfunction showTask(name) {\n  docname.value = name\n  showTaskModal.value = true\n}\n</script>\n"],"names":["props","__props","getUser","isManager","usersStore","getDealStatus","statusOptions","statusesStore","show","_useModel","router","useRouter","error","ref","deal","triggerOnBeforeCreate","useDocument","hasOrganizationSections","hasContactSections","isDealCreating","chooseExistingContact","chooseExistingOrganization","fieldLayoutRef","watch","organization","contact","tabs","tab","section","createResource","_tabs","column","field","dealStatuses","computed","statuses","createDeal","name","capture","err","openQuickEntryModal","showQuickEntryModal","quickEntryProps","nextTick","onMounted","_createBlock","_component_Dialog","$event","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_toDisplayString","__","_hoisted_4","_unref","isMobileView","_component_Button","EditIcon","_createVNode","_openBlock","_createElementBlock","_hoisted_5","_hoisted_6","Switch","_hoisted_7","_hoisted_8","FieldLayout","_component_ErrorMessage","_hoisted_9","_hoisted_10","getFormattedPercent","getFormattedFloat","getFormattedCurrency","getMeta","makeCall","globalStore","getOrganization","organizationsStore","route","useRoute","dealsListView","showDealModal","defaults","reactive","deals","loadMore","triggerResize","updatedPageCount","viewControls","getRow","getValue","value","_a","rows","row","_b","_d","_c","getGroupedByRows","_e","_f","getKanbanRows","parseRows","_g","listRows","groupByField","columns","groupedRows","option","filteredRows","groupDetail","h","IndicatorIcon","data","_rows","view_type","key","type","fieldType","col","formatDate","website","tooltipText","color","timeAgo","assignees","user","formatTime","onNewClick","column_field","actions","itemName","mobile_no","PhoneIcon","callEnabled","NoteIcon","showNote","TaskIcon","showTask","action","docname","showNoteModal","note","showTaskModal","task","LayoutHeader","ViewBreadcrumbs","CustomActions","ViewControls","KanbanView","columnName","_withCtx","titleField","Avatar","Tooltip","_component_Badge","fieldName","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","MultipleAvatar","_hoisted_16","_hoisted_17","_hoisted_18","EmailAtIcon","_hoisted_19","_cache","_hoisted_20","_hoisted_21","CommentIcon","_hoisted_22","Dropdown","DealsListView","count","selections","_hoisted_23","_hoisted_24","DealsIcon","DealModal","NoteModal","TaskModal"],"mappings":"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"}