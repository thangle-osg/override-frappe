{"version":3,"file":"DealsListView-56ea56b1.js","sources":["../../../../frontend/src/components/ListViews/DealsListView.vue"],"sourcesContent":["<template>\n  <ListView\n    :class=\"$attrs.class\"\n    :columns=\"columns\"\n    :rows=\"rows\"\n    :options=\"{\n      getRowRoute: (row) => ({\n        name: 'Deal',\n        params: { dealId: row.name },\n        query: { view: route.query.view, viewType: route.params.viewType },\n      }),\n      selectable: options.selectable,\n      showTooltip: options.showTooltip,\n      resizeColumn: options.resizeColumn,\n    }\"\n    row-key=\"name\"\n    @update:selections=\"(selections) => emit('selectionsChanged', selections)\"\n  >\n    <ListHeader\n      class=\"sm:mx-5 mx-3\"\n      @columnWidthUpdated=\"emit('columnWidthUpdated')\"\n    >\n      <ListHeaderItem\n        v-for=\"column in columns\"\n        :key=\"column.key\"\n        :item=\"column\"\n        @columnWidthUpdated=\"emit('columnWidthUpdated', column)\"\n      >\n        <Button\n          v-if=\"column.key == '_liked_by'\"\n          variant=\"ghosted\"\n          class=\"!h-4\"\n          :class=\"isLikeFilterApplied ? 'fill-red-500' : 'fill-white'\"\n          @click=\"() => emit('applyLikeFilter')\"\n        >\n          <HeartIcon class=\"h-4 w-4\" />\n        </Button>\n      </ListHeaderItem>\n    </ListHeader>\n    <ListRows\n      :rows=\"rows\"\n      v-slot=\"{ idx, column, item, row }\"\n      doctype=\"CRM Deal\"\n    >\n      <div v-if=\"column.key === '_assign'\" class=\"flex items-center\">\n        <MultipleAvatar\n          :avatars=\"item\"\n          size=\"sm\"\n          @click=\"\n            (event) =>\n              emit('applyFilter', {\n                event,\n                idx,\n                column,\n                item,\n                firstColumn: columns[0],\n              })\n          \"\n        />\n      </div>\n      <ListRowItem v-else :item=\"item\" :align=\"column.align\">\n        <template #prefix>\n          <div v-if=\"column.key === 'status'\">\n            <IndicatorIcon :class=\"item.color\" />\n          </div>\n          <div v-else-if=\"column.key === 'organization'\">\n            <Avatar\n              v-if=\"item.label\"\n              class=\"flex items-center\"\n              :image=\"item.logo\"\n              :label=\"item.label\"\n              size=\"sm\"\n            />\n          </div>\n          <div v-else-if=\"column.key === 'deal_owner'\">\n            <Avatar\n              v-if=\"item.full_name\"\n              class=\"flex items-center\"\n              :image=\"item.user_image\"\n              :label=\"item.full_name\"\n              size=\"sm\"\n            />\n          </div>\n          <div v-else-if=\"column.key === 'mobile_no'\">\n            <PhoneIcon class=\"h-4 w-4\" />\n          </div>\n          <div v-else-if=\"column.key === '_liked_by'\">\n            <Button\n              v-if=\"column.key == '_liked_by'\"\n              variant=\"ghosted\"\n              :class=\"isLiked(item) ? 'fill-red-500' : 'fill-white'\"\n              @click.stop.prevent=\"\n                () => emit('likeDoc', { name: row.name, liked: isLiked(item) })\n              \"\n            >\n              <HeartIcon class=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </template>\n        <template #default=\"{ label }\">\n          <div\n            v-if=\"\n              [\n                'modified',\n                'creation',\n                'first_response_time',\n                'first_responded_on',\n                'response_by',\n              ].includes(column.key)\n            \"\n            class=\"truncate text-base\"\n            @click=\"\n              (event) =>\n                emit('applyFilter', {\n                  event,\n                  idx,\n                  column,\n                  item,\n                  firstColumn: columns[0],\n                })\n            \"\n          >\n            <Tooltip :text=\"item.label\">\n              <div>{{ item.timeAgo }}</div>\n            </Tooltip>\n          </div>\n          <div\n            v-else-if=\"column.key === 'sla_status'\"\n            class=\"truncate text-base\"\n          >\n            <Badge\n              v-if=\"item.value\"\n              :variant=\"'subtle'\"\n              :theme=\"item.color\"\n              size=\"md\"\n              :label=\"item.value\"\n              @click=\"\n                (event) =>\n                  emit('applyFilter', {\n                    event,\n                    idx,\n                    column,\n                    item,\n                    firstColumn: columns[0],\n                  })\n              \"\n            />\n          </div>\n          <div v-else-if=\"column.type === 'Check'\">\n            <FormControl\n              type=\"checkbox\"\n              :modelValue=\"item\"\n              :disabled=\"true\"\n              class=\"text-ink-gray-9\"\n            />\n          </div>\n          <div\n            v-else\n            class=\"truncate text-base\"\n            @click=\"\n              (event) =>\n                emit('applyFilter', {\n                  event,\n                  idx,\n                  column,\n                  item,\n                  firstColumn: columns[0],\n                })\n            \"\n          >\n            {{ label }}\n          </div>\n        </template>\n      </ListRowItem>\n    </ListRows>\n    <ListSelectBanner>\n      <template #actions=\"{ selections, unselectAll }\">\n        <Dropdown\n          :options=\"listBulkActionsRef.bulkActions(selections, unselectAll)\"\n        >\n          <Button icon=\"more-horizontal\" variant=\"ghost\" />\n        </Dropdown>\n      </template>\n    </ListSelectBanner>\n  </ListView>\n  <ListFooter\n    v-if=\"pageLengthCount\"\n    class=\"border-t sm:px-5 px-3 py-2\"\n    v-model=\"pageLengthCount\"\n    :options=\"{\n      rowCount: options.rowCount,\n      totalCount: options.totalCount,\n    }\"\n    @loadMore=\"emit('loadMore')\"\n  />\n  <ListBulkActions ref=\"listBulkActionsRef\" v-model=\"list\" doctype=\"CRM Deal\" />\n</template>\n\n<script setup>\nimport HeartIcon from '@/components/Icons/HeartIcon.vue'\nimport MultipleAvatar from '@/components/MultipleAvatar.vue'\nimport IndicatorIcon from '@/components/Icons/IndicatorIcon.vue'\nimport PhoneIcon from '@/components/Icons/PhoneIcon.vue'\nimport ListBulkActions from '@/components/ListBulkActions.vue'\nimport ListRows from '@/components/ListViews/ListRows.vue'\nimport {\n  Avatar,\n  ListView,\n  ListHeader,\n  ListHeaderItem,\n  ListRowItem,\n  ListSelectBanner,\n  ListFooter,\n  Dropdown,\n  Tooltip,\n} from 'frappe-ui'\nimport { sessionStore } from '@/stores/session'\nimport { ref, computed, watch } from 'vue'\nimport { useRoute } from 'vue-router'\n\nconst props = defineProps({\n  rows: {\n    type: Array,\n    required: true,\n  },\n  columns: {\n    type: Array,\n    required: true,\n  },\n  options: {\n    type: Object,\n    default: () => ({\n      selectable: true,\n      showTooltip: true,\n      resizeColumn: false,\n      totalCount: 0,\n      rowCount: 0,\n    }),\n  },\n})\n\nconst emit = defineEmits([\n  'loadMore',\n  'updatePageCount',\n  'columnWidthUpdated',\n  'applyFilter',\n  'applyLikeFilter',\n  'likeDoc',\n  'selectionsChanged',\n])\n\nconst route = useRoute()\n\nconst pageLengthCount = defineModel()\nconst list = defineModel('list')\n\nconst isLikeFilterApplied = computed(() => {\n  return list.value.params?.filters?._liked_by ? true : false\n})\n\nconst { user } = sessionStore()\n\nfunction isLiked(item) {\n  if (item) {\n    let likedByMe = JSON.parse(item)\n    return likedByMe.includes(user)\n  }\n}\n\nwatch(pageLengthCount, (val, old_value) => {\n  if (val === old_value) return\n  emit('updatePageCount', val)\n})\n\nconst listBulkActionsRef = ref(null)\n\ndefineExpose({\n  customListActions: computed(\n    () => listBulkActionsRef.value?.customListActions,\n  ),\n})\n</script>\n"],"names":["emit","__emit","route","useRoute","pageLengthCount","_useModel","__props","list","isLikeFilterApplied","computed","_b","_a","user","sessionStore","isLiked","item","watch","val","old_value","listBulkActionsRef","ref","__expose","_createVNode","_unref","ListView","_normalizeClass","$attrs","row","_cache","selections","ListHeader","_createElementBlock","_Fragment","_renderList","column","_createBlock","ListHeaderItem","$event","_component_Button","HeartIcon","ListRows","_withCtx","idx","_openBlock","_hoisted_1","MultipleAvatar","event","ListRowItem","_hoisted_2","IndicatorIcon","_hoisted_3","Avatar","_hoisted_4","_hoisted_5","PhoneIcon","_hoisted_6","_withModifiers","label","Tooltip","_createElementVNode","_toDisplayString","_hoisted_8","_component_Badge","_hoisted_9","_component_FormControl","_hoisted_10","ListSelectBanner","unselectAll","Dropdown","ListFooter","ListBulkActions"],"mappings":"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"}